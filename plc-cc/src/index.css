/* ==========================================================================
   Private Life Command Center — Premium UI
   - Elegant, minimal, executive aesthetic
   - Light (“ivory”) & Dark (“noir”) themes
   - iPhone & iPad responsive layouts
   ========================================================================== */

/* ----------------------- Reset / Base ----------------------------------- */
*,
*::before,
*::after { box-sizing: border-box; }
html, body, #root { height: 100%; }
html { -webkit-text-size-adjust: 100%; }
body {
  margin: 0;
  font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI",
               Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  line-height: 1.4;
  letter-spacing: 0.01em;
  background: var(--paper);
  color: var(--ink);
}

:root {
  /* neutral spacing and radii */
  --radius: 14px;
  --radius-lg: 18px;
  --radius-sm: 10px;

  --shadow-1: 0 1px 2px rgba(0,0,0,.04), 0 6px 18px rgba(0,0,0,.05);
  --shadow-2: 0 2px 8px rgba(0,0,0,.08), 0 14px 40px rgba(0,0,0,.10);
  --shadow-soft-inset: inset 0 1px 0 rgba(255,255,255,.08);

  --gold: #C5B489;            /* champagne accent */
  --gold-soft: #D8CCAC;       /* softer for borders/rules */
}

/* ---- Ivory (light) ---- */
body[data-theme="ivory"] {
  --paper: #FAF9F6;
  --surface: #FFFFFF;
  --ink: #121212;
  --ink-2: #3A3A3A;
  --ink-3: #6D6A63;
  --line: #E7E3DC;

  --btn: #111111;
  --btn-ink: #FFFFFF;

  --elev-1: var(--shadow-1);
  --elev-2: var(--shadow-2);
}

/* ---- Noir (dark) ---- */
body[data-theme="noir"] {
  --paper: #0F0F0F;
  --surface: #141414;
  --ink: #F4F2EC;
  --ink-2: #D7D3C8;
  --ink-3: #A9A69D;
  --line: #262626;

  --btn: #ECE8DF;   /* refined, not bright white */
  --btn-ink: #0F0F0F;

  --elev-1: 0 1px 2px rgba(0,0,0,.35), 0 10px 30px rgba(0,0,0,.45);
  --elev-2: 0 2px 10px rgba(0,0,0,.45), 0 18px 60px rgba(0,0,0,.55);
}

a { color: inherit; text-decoration: none; }
button { font: inherit; color: inherit; cursor: pointer; }

/* ----------------------- App Shell -------------------------------------- */
.app { min-height: 100%; display: flex; flex-direction: column; }
.shell { display: grid; grid-template-columns: 240px 1fr; gap: 0; }

/* Top bar */
.topbar {
  backdrop-filter: saturate(120%) blur(8px);
  position: sticky; top: 0; z-index: 40;
  border-bottom: 1px solid var(--line);
  background: color-mix(in oklab, var(--paper) 88%, transparent);
}
.topbar-inner {
  max-width: 1280px; margin: 0 auto;
  display: flex; align-items: center; justify-content: space-between;
  padding: 10px 16px;
}
.brand { display: flex; align-items: center; gap: 12px; color: var(--ink); }
.monogram {
  width: 36px; height: 36px; display: grid; place-items: center;
  border-radius: 10px; border: 1px solid var(--line);
  background: linear-gradient(180deg, var(--surface), color-mix(in srgb, var(--surface), #000 6%));
  box-shadow: var(--elev-1);
}
.brand-subtle { font-size: 12px; color: var(--ink-3); }
.brand-strong { font-size: 14px; font-weight: 700; letter-spacing: .02em; }

.actions { display: flex; gap: 8px; }

/* Sidebar */
.sidebar {
  border-right: 1px solid var(--line);
  background: linear-gradient(180deg, var(--surface), color-mix(in srgb, var(--surface), #000 5%));
  min-height: calc(100dvh - 52px);
  padding: 12px;
}
.nav { display: grid; gap: 6px; }
.nav button {
  text-align: left; padding: 10px 12px; border-radius: 10px; border: 1px solid transparent;
  background: transparent; color: var(--ink-2);
}
.nav button:hover { background: color-mix(in srgb, var(--surface), #000 6%); border-color: var(--line); color: var(--ink); }
.nav button.active { background: color-mix(in srgb, var(--surface), #000 10%); border-color: var(--line); color: var(--ink); }

.main { padding: 20px; }

/* ----------------------- Typography & Layout ----------------------------- */
.container { max-width: 1280px; margin: 0 auto; }
.section { background: transparent; border-radius: var(--radius); }
.section + .section { margin-top: 16px; }

.section-header {
  display: flex; align-items: baseline; justify-content: space-between;
  padding: 6px 2px 10px 2px;
}
.h-with-rule {
  font-size: 16px; font-weight: 700; margin: 0;
  position: relative; padding-right: 8px;
}
.h-with-rule::after {
  content: ""; display: inline-block; vertical-align: middle;
  height: 1px; width: 56px; margin-left: 10px;
  background: color-mix(in srgb, var(--gold), var(--line) 46%);
  border-radius: 999px;
}
.meta { color: var(--ink-3); font-size: 12px; }

.grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }

/* Cards & Lists */
.card {
  border: 1px solid var(--line);
  background: var(--surface);
  border-radius: var(--radius);
  box-shadow: var(--elev-1);
  padding: 14px;
}
.list { display: grid; gap: 10px; }
.inbox-item {
  border: 1px solid var(--line);
  background: var(--surface);
  border-radius: var(--radius);
  padding: 12px 14px;
  box-shadow: var(--elev-1);
}
.dec-card {
  border: 1px solid var(--line); background: var(--surface);
  border-radius: var(--radius); padding: 12px 14px; box-shadow: var(--elev-1);
}
.dec-head { display:flex; gap:8px; align-items:center; justify-content: space-between; color: var(--ink-3); }
.dec-title { font-weight: 700; margin-top: 4px; }
.dec-sub { color: var(--ink-3); font-size: 13px; margin-top: 2px; }

.log-row { display: grid; gap: 4px; padding: 10px 12px; border: 1px solid var(--line); border-radius: var(--radius-sm); background: var(--surface); box-shadow: var(--elev-1);}
.log-title { font-weight: 600; }
.row-sub { color: var(--ink-3); font-size: 12px; }
.row-title { font-weight: 600; }

/* Strip (dashboard header) */
.strip {
  display: grid; grid-template-columns: auto 1fr auto auto; gap: 12px;
  align-items: center; margin-bottom: 12px;
}
.strip-item {
  display: flex; align-items: center; gap: 8px;
  border: 1px solid var(--line); background: var(--surface);
  padding: 10px 12px; border-radius: var(--radius); box-shadow: var(--elev-1);
}
.strip-cta { margin-left: auto; }
.strip-main { display: grid; gap: 2px; }
.strip-title { font-weight: 700; }
.strip-sub { color: var(--ink-3); font-size: 12px; display:flex; gap:8px; align-items:center; }
.dot { width: 8px; height: 8px; border-radius: 999px; background: var(--gold); }
.dot--next { box-shadow: 0 0 0 3px color-mix(in srgb, var(--gold), transparent 70%); }

/* ----------------------- Buttons & Chips -------------------------------- */
.btn {
  border: 1px solid var(--line);
  background: var(--surface);
  color: var(--ink);
  border-radius: 999px;
  padding: 8px 12px;
  display: inline-flex; align-items: center; justify-content: center; gap: 8px;
}
.btn:hover { background: color-mix(in srgb, var(--surface), #000 6%); }
.btn:disabled { opacity: .6; cursor: not-allowed; }

.btn-primary {
  border: 1px solid color-mix(in srgb, var(--btn), #000 12%);
  background: var(--btn); color: var(--btn-ink);
  box-shadow: var(--elev-1);
}
.btn-primary:hover { filter: brightness(.96); }
.btn-ghost {
  background: transparent; color: var(--ink-2);
}
.btn-ghost:hover { background: color-mix(in srgb, var(--surface), #000 7%); color: var(--ink); }

.ring:focus { outline: 2px solid color-mix(in srgb, var(--gold), transparent 40%); outline-offset: 2px; }

.badge {
  min-width: 28px; height: 28px; padding: 0 8px; display: inline-grid; place-items: center;
  border: 1px solid var(--line); border-radius: 999px; background: var(--surface); box-shadow: var(--elev-1); font-weight: 700;
}
.badge--alert { background: color-mix(in srgb, #ffefef, var(--surface) 60%); border-color: color-mix(in srgb, #ffcccc, var(--line)); }

.pill {
  border: 1px solid var(--line); padding: 2px 8px; border-radius: 999px;
  font-size: 12px; background: color-mix(in srgb, #e8f6ec, var(--surface) 50%);
}
.pill--late { background: color-mix(in srgb, #ffefef, var(--surface) 40%); }

.chip {
  border: 1px solid var(--line); border-radius: 999px; padding: 2px 8px; font-size: 12px;
  background: color-mix(in srgb, var(--surface), #000 4%);
}

/* Status & Priority tags */
.tag { border-radius: 999px; padding: 4px 10px; font-size: 12px; border: 1px solid var(--line); background: var(--surface); }
.tag--open { }
.tag--progress { background: color-mix(in srgb, #e7f0ff, var(--surface) 60%); border-color: color-mix(in srgb, #c9dfff, var(--line) 50%); }
.tag--done { background: color-mix(in srgb, #ecf9ef, var(--surface) 60%); border-color: color-mix(in srgb, #d6f1db, var(--line) 50%); }

.tag--low { }
.tag--medium { background: color-mix(in srgb, #fff9e6, var(--surface) 60%); border-color: color-mix(in srgb, #ffe9a8, var(--line) 50%); }
.tag--high { background: color-mix(in srgb, #ffece6, var(--surface) 60%); border-color: color-mix(in srgb, #ffd1c6, var(--line) 50%); }
.tag--urgent { background: color-mix(in srgb, #ffe2e2, var(--surface) 55%); border-color: color-mix(in srgb, #ffcaca, var(--line) 50%); }

/* ----------------------- Tables ----------------------------------------- */
.table { width: 100%; border-collapse: separate; border-spacing: 0; font-size: 14px; }
.table thead th {
  text-align: left; font-weight: 600; color: var(--ink-3);
  padding: 10px 12px; border-bottom: 1px solid var(--line);
  position: sticky; top: 0; background: var(--paper); z-index: 1;
}
.table tbody td { padding: 12px; border-bottom: 1px solid var(--line); vertical-align: top; }
.table-scroll { max-height: 52vh; overflow: auto; border: 1px solid var(--line); border-radius: var(--radius); background: var(--surface); box-shadow: var(--elev-1); }
.row-actions { display: flex; gap: 8px; align-items: center; }
.row-click:hover { background: color-mix(in srgb, var(--surface), #000 5%); }

/* ----------------------- Forms ------------------------------------------ */
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.field { display: grid; gap: 6px; }
.field label { font-size: 12px; color: var(--ink-3); }
.input, .select, .textarea {
  width: 100%; border: 1px solid var(--line); background: var(--surface);
  border-radius: 12px; padding: 10px 12px; color: var(--ink); box-shadow: var(--shadow-soft-inset);
}
.textarea { resize: vertical; }
.input::placeholder, .textarea::placeholder { color: color-mix(in srgb, var(--ink-3), transparent 20%); }

/* Toolbar */
.toolbar { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }

/* ----------------------- Modal & Drawer --------------------------------- */
.modal-backdrop,
.drawer-backdrop {
  position: fixed; inset: 0; background: rgba(0,0,0,.3); z-index: 60;
  display: grid; place-items: center;
}
.modal {
  width: min(680px, 92vw);
  border: 1px solid var(--line); background: var(--surface);
  border-radius: var(--radius-lg); box-shadow: var(--elev-2);
  padding: 16px;
}
.drawer {
  position: fixed; right: 0; top: 0; bottom: 0; width: min(520px, 96vw);
  border-left: 1px solid var(--line); background: var(--surface);
  box-shadow: var(--elev-2); z-index: 70; display: flex; flex-direction: column;
}
.drawer-head, .drawer-foot { padding: 14px; border-bottom: 1px solid var(--line); }
.drawer-foot { border-top: 1px solid var(--line); border-bottom: 0; display:flex; gap:8px; justify-content:flex-end; }
.drawer-body { padding: 14px; overflow: auto; }

/* ----------------------- Toasts ----------------------------------------- */
.toast-host { position: fixed; right: 14px; bottom: 14px; display: grid; gap: 8px; z-index: 80; }
.toast {
  display: flex; gap: 8px; align-items: center; border-radius: 12px; padding: 10px 12px;
  border: 1px solid var(--line); background: var(--surface); box-shadow: var(--elev-1);
}
.toast--ok { }
.toast--info { opacity: .9; }

/* ----------------------- Alerts ----------------------------------------- */
.alert {
  display: grid; grid-template-columns: auto 1fr auto; gap: 12px; align-items: center;
  padding: 12px 14px; border-radius: var(--radius); border: 1px solid var(--line); background: var(--surface); box-shadow: var(--elev-1);
}
.alert-dot { width: 8px; height: 8px; border-radius: 999px; background: var(--gold); }
.alert--high { border-color: color-mix(in srgb, #ffb3b3, var(--line)); background: color-mix(in srgb, #fff1f1, var(--surface) 60%); }
.alert--med { border-color: color-mix(in srgb, #ffe2b3, var(--line)); background: color-mix(in srgb, #fff7ea, var(--surface) 60%); }

/* ----------------------- Calendar --------------------------------------- */
.calendar-week {
  display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px;
}
.calendar-day {
  border: 1px solid var(--line); background: var(--surface);
  border-radius: var(--radius); padding: 10px; box-shadow: var(--elev-1);
}
.calendar-block {
  padding: 10px; border-radius: 12px;
  background: linear-gradient(180deg, var(--surface), color-mix(in srgb, var(--surface), #000 6%));
  border: 1px solid var(--line); margin-bottom: 8px;
}

/* ----------------------- Stats ------------------------------------------ */
.stat { display: flex; justify-content: space-between; align-items: baseline; padding: 8px 0; border-bottom: 1px dashed color-mix(in srgb, var(--line), transparent 40%); }
.stat:last-child { border-bottom: none; }
.stat-label { color: var(--ink-3); font-size: 12px; }
.stat-value { font-weight: 700; }
.stat-value.neg { color: #B74A4A; }

/* ==========================================================================
   Mobile — iPhone (≤ 480px)
   Refined, understated, premium
   ========================================================================== */
@media (max-width: 480px) {
  .topbar, .sidebar { display: none; }
  .shell { grid-template-columns: 1fr; }
  .main { padding: 0; }
  .container { max-width: none; }

  /* Header slab with subtle gradient */
  .mobile-shell { padding-bottom: 74px; }
  .mobile-header {
    color: #fff;
    padding: 20px 16px 14px;
    border-bottom-left-radius: 18px;
    border-bottom-right-radius: 18px;
    background:
      radial-gradient(120% 120% at 0% 0%, rgba(255,255,255,.12) 0%, rgba(255,255,255,0) 60%),
      linear-gradient(180deg, #0b0b0b 0%, #0a0a0a 100%);
    box-shadow: 0 10px 30px rgba(0,0,0,.25);
  }
  .mh-sub { display: flex; gap: 8px; align-items: center; opacity: .9; }
  .mh-status { margin-top: 8px; display: flex; align-items: center; gap: 6px; opacity: .85; }

  /* Action rows */
  .action {
    display: flex; align-items: center; gap: 12px;
    padding: 14px 16px; width: 100%;
    border-radius: 16px; border: 1px solid var(--line);
    background: var(--surface);
    box-shadow: var(--elev-1);
    font-weight: 600; text-align: left;
  }
  .action--lg { align-items: flex-start; gap: 4px; position: relative; }
  .action--lg .a-label { font-weight: 600; }
  .action--lg .a-sub { font-size: 13px; color: var(--ink-3); }
  .action .a-arrow { margin-left: auto; opacity: .45; font-size: 20px; line-height: 1; }

  /* Chat composer (home) */
  .mobile-chatbar {
    position: fixed; left: 0; right: 0; bottom: 56px;
    display: flex; gap: 8px; padding: 10px 12px;
    background: color-mix(in srgb, var(--paper), transparent 0%);
    border-top: 1px solid var(--line);
    backdrop-filter: saturate(120%) blur(8px);
  }
  .chat-input {
    flex: 1; border-radius: 999px; padding: 12px 14px;
    border: 1px solid var(--line); background: var(--surface);
  }
  .chat-send { border-radius: 999px; padding: 0 16px; }

  /* Bottom tab bar */
  .tabbar {
    position: fixed; left: 0; right: 0; bottom: 0; height: 56px;
    background: var(--surface); border-top: 1px solid var(--line);
    display: flex; justify-content: space-around; align-items: center; z-index: 50;
    box-shadow: var(--elev-1);
  }
  .tabbar button {
    position: relative; background: none; border: none;
    display: grid; place-items: center; gap: 4px;
    font-size: 12px; color: var(--ink-3);
  }
  .tabbar button .icon { font-size: 16px; line-height: 1; }
  .tabbar button.active { color: var(--ink); font-weight: 600; }
  .tab-badge {
    position: absolute; top: 4px; right: 14px; min-width: 16px; height: 16px; padding: 0 4px;
    border-radius: 999px; background: #111; color: #fff; font-size: 10px; display: grid; place-items: center;
  }
  body[data-theme="noir"] .tab-badge { background: #e9e6df; color: #0f0f0f; }

  /* Chat view */
  .chat-view { display: flex; flex-direction: column; height: 100dvh; background: var(--paper); }
  .chat-log { flex: 1; overflow: auto; padding: 12px; }
  .chat-msg {
    max-width: 78%; padding: 10px 12px; border: 1px solid var(--line);
    border-radius: 14px; margin-bottom: 8px; box-shadow: var(--elev-1);
    background: var(--surface);
  }
  .chat-msg.me { margin-left: auto; }
  .chat-msg.them {
    background: linear-gradient(180deg, #101010, #0b0b0b); color: #fff; border-color: #000;
  }
  .chat-composer {
    position: sticky; bottom: 0; background: var(--paper); border-top: 1px solid var(--line);
    display: flex; gap: 8px; padding: 10px 12px;
  }
}

/* ==========================================================================
   Tablet — iPad (481px – 1024px)
   ========================================================================== */
@media (min-width: 481px) and (max-width: 1024px) {
  .sidebar { width: 220px; }
  .grid-3 { grid-template-columns: 1fr 1fr; }
  .tablet-grid { display: grid; grid-template-columns: 1.25fr .75fr; gap: 16px; }
  .tablet-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
}

/* ==========================================================================
   Small niceties
   ========================================================================== */
.mono-note { color: var(--ink-3); font-size: 12px; font-variant-numeric: tabular-nums; }
.row-click { transition: background .15s ease; }
.hidden { display: none !important; }
/* ===== Mobile Premium Overrides (iPhone) ===== */
@media (max-width: 480px) {
  /* Safer, explicit palette (no color-mix) */
  body[data-theme="noir"] {
    --paper: #0f0f0f;
    --surface: #141414;
    --ink: #F4F2EC;
    --ink-2: #D7D3C8;
    --ink-3: #A9A69D;
    --line: #232323;
  }
  body[data-theme="ivory"] {
    --paper: #FAF9F6;
    --surface: #FFFFFF;
    --ink: #121212;
    --ink-2: #3A3A3A;
    --ink-3: #6D6A63;
    --line: #E7E3DC;
  }

  /* Reduce tap highlight and keep text crisp */
  body { -webkit-tap-highlight-color: transparent; text-rendering: optimizeLegibility; }

  /* Inputs look odd on iOS without this */
  input, select, textarea { -webkit-appearance: none; background-clip: padding-box; }

  /* Ensure nothing gets hidden under bottom UI */
  .mobile-shell { padding-bottom: 128px; } /* chat bar + tab bar */

  /* Header slab: explicit gradient (no color-mix) */
  .mobile-header {
    background: radial-gradient(120% 120% at 0% 0%, rgba(255,255,255,.10) 0%, rgba(255,255,255,0) 60%),
                linear-gradient(180deg, #0b0b0b 0%, #0a0a0a 100%);
    color: #fff;
    border-bottom-left-radius: 18px;
    border-bottom-right-radius: 18px;
    box-shadow: 0 10px 30px rgba(0,0,0,.28);
  }

  /* Action rows: higher contrast, calmer */
  .action {
    background: var(--surface);
    border: 1px solid var(--line);
    color: var(--ink);
  }
  .action--lg .a-label { font-weight: 600; }
  .action--lg .a-sub { color: var(--ink-3); }
  .action .a-arrow { opacity: .45; }

  /* Chat composer: above tab bar, never hidden */
  .mobile-chatbar {
    position: fixed;
    left: 0; right: 0;
    bottom: 56px;          /* sits above the tab bar */
    z-index: 60;           /* ensure above tabbar (which is z-index: 50) */
    background: var(--paper);
    border-top: 1px solid var(--line);
    backdrop-filter: saturate(120%) blur(8px);
  }
  .chat-input { background: var(--surface); border: 1px solid var(--line); color: var(--ink); }
  .chat-input::placeholder { color: var(--ink-3); }
  .chat-send { background: var(--btn); color: var(--btn-ink); border: 1px solid rgba(0,0,0,.08); }

  /* Chat bubbles: balanced contrast */
  .chat-msg.me { background: #171717; border-color: #232323; color: var(--ink); }
  .chat-msg.them { background: #0e0e0e; border-color: #000; color: #F4F2EC; }

  /* Tab bar: explicit colors (no color-mix) */
  .tabbar {
    background: var(--surface);
    border-top: 1px solid var(--line);
    z-index: 50;
    box-shadow: 0 2px 8px rgba(0,0,0,.08), 0 -10px 30px rgba(0,0,0,.12);
  }
  .tabbar button { color: var(--ink-3); }
  .tabbar button.active { color: var(--ink); font-weight: 600; }

  /* Badge contrast per theme */
  body[data-theme="ivory"] .tab-badge { background: #111; color: #fff; }
  body[data-theme="noir"]  .tab-badge { background: #EDE9DF; color: #0f0f0f; }

  /* Pills & chips: explicit backgrounds */
  .pill { background: #edf1ea; border: 1px solid var(--line); }
  .pill--late { background: #fff1f1; }
}
